Salt Cloud:
	Post-acion:
		☐ Add DNS in OVH => use the external_pillar to fill the DNS is missing entries + additionnal domaine from pillar
		☐ Mount IPv6 => use the external_pillar "all_ips", and mount missing IPv6

Docker:
	☐ Find a way to restart docker on nftables reload @critical 
		* see with systemd dependancies (nft reload -> reload docker)
		* otherwise add a "onchanges_in" dans un state

Backup management:
	☐ Automate the first borg-init using the borgwrapper (peut etre facilité par sshfp)

SSH:
	☐ Passer en sshfp
		* Permettra d'eviter le check de fingerprint (yes/no) a la premiere connexion (borg!) 
		* Au moins pour le serveur Borg dans un premier temps (sshfp pour lui + modification conf sur les autres)
		☐ tester si le champ DNS exist et est different
		☐ remonter les clefs au server salt `ssh-keygen -r {{ grains['host'] }}` 
		☐ reactor sur le master qui modifie les champs DNS sur OVH + DNS sur srv002 (quand DNS dans salt)
		☐ Modifier la conf SSHD pour check : http://shaarli.guiguishow.info/?QWcOtQ

Monitoring:
	☐ Wigo : Monitoring local des containers docker (pas de docker en exited)
	☐ Wigo : Monitorer le backup, il faut un backup de moins de 48H -> sinon alerte

Bastion:
	☐ monitoring docker access to bastion
	☐ if down -> restart docker ! (implement a beacon?)
	☐ Find a way to auto add host in bastion and group

Warden:
	☐ Automatiser l'installation
		* curl (?) vs depot fichier
	☐ Automatiser update (schedule regulier)
		* updateself
		* update

srv002:
	hassio:
		☐ Automatiser installation + restore
		☐ Automatiser update ?
	DNS management on local_dns:
		☐ Configure DNS on srv002 via salt
			* https://github.com/saltstack-formulas/bind-formula

Saltstack (vps001):
	☐ Mettre sous salt la conf salt (surtout la partie cloud)


Archive:
  ✔ Add roles on /etc/salt/grains (done via *.map for salt-cloud) @done(19-11-21 09:52) @project(Salt Cloud.Pre-action)
  ✔ Add Ip in nftables pillar @done(19-11-28 14:53) @project(Salt Cloud.Post-acion)
  ✔ Find an event to catch (salt/auth ?) and get IP or use mine @done(19-11-28 10:44) @project(Salt Cloud.Post-acion)
  ✔ Use those informations to generate the host-ips.jinja @done(19-11-28 10:44) @project(Salt Cloud.Post-acion)
  ✔ Add thoses ip in Wigo too @done(19-11-28 14:53) @project(Salt Cloud.Post-acion)
  ✔ mount vrack @done(19-11-21 09:55) @project(Salt Cloud.Post-acion)
  ✔ Set a default password @done(19-11-21 09:55) @project(Salt Cloud.applying)
  ✔ Add sudoers.d rules for user @done(19-11-21 09:56) @project(Salt Cloud.applying)
  ✔ manage /etc/hosts @done(19-11-21 09:56) @project(Salt Cloud.applying)
  ✔ Use borgbackup @done(19-11-22 11:10) @project(Backup management)
  ✔ Two roles BackupServer and BackupAgent (= not BackupServer) @done(19-11-22 11:10) @project(Backup management)
  ✔ Use event to propagate key (when installing borg on client) @done(19-11-22 11:11) @project(Backup management)
  ✔ Use reactor to catch event and push the new key on borg server @done(19-11-22 11:11) @project(Backup management)
  ✔ Monitoring ext. des sitewebs (all, portainer/koel/grafana/etc...) @done(19-11-29 11:04) @project(Monitoring)
  ✔ * choice : free saas @done(19-11-29 11:04) => freshping.io @project(Monitoring)
  ✘ choice : my own ping / curl testing host on wazuh with wigo ? @cancelled(19-11-29 16:45) @project(Monitoring)
  ✔ Mettre sous salt la partie webhook @done(19-11-21 09:59) @project(Saltstack (vps001))
  ✔ Mettre en place l'auto-deploy par webhook pour le git salt @done(19-11-21 09:59) @project(Saltstack (vps001))
  ✔ Faire marcher le salt-lint sur github action (check) @done(19-11-21 09:59) @project(Saltstack (vps001))
